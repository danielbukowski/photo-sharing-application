<app-navbar></app-navbar>
<div class="min-h-screen bg-white mx-14 dark:bg-gray-800">
  <div>
    <div
      class="bg-gray-100 py-4 flex justify-center max-h-screen min-w-full dark:bg-slate-700"
    >
      <img
        src="http://localhost:8081/api/v1/images/{{
          this.IdOfCurrentDisplayedImage()
        }}"
        alt="main-image"
      />
    </div>
    <hr />
    <div class="my-4 mx-6">
      <div *ngIf="this.accountDetails()?.isEmailVerified">
        <div class="my-2">
          <h2 class="text-center">Type what you think about this image!</h2>
        </div>
        <textarea
          name="comment-content"
          id="comment-content"
          rows="2"
          maxlength="255"
          class="border-2 text-black border-gray-300 w-full dark:bg-slate-800 dark:border-slate-700 focus:dark:outline focus:dark:outline-gray-300"
          #commentContent
        ></textarea>
        <button
          type="submit"
          (click)="addCommentToImage(commentContent)"
          class="bg-white font-medium rounded-lg border-2 text-sm px-5 py-2.5 mx-auto block dark:bg-slate-800 dark:hover:bg-slate-700 dark:border-slate-700"
        >
          Add your comment!
        </button>
      </div>
      <div *ngIf="commentPage$ | async as commentPage">
        <h3 class="text-center mt-3 mb-0">Users comments</h3>
        <div class="mt-7 mb-2">
          <div class="m-5 border-2" *ngFor="let comment of commentPage.data">
            <div>
              <p>{{ comment.authorEmail }}</p>
            </div>
            <div>
              <p class="ml-2 py-2">{{ comment.content }}</p>
            </div>
          </div>
        </div>
        <div class="flex flex-col items-center">
          <span class="text-sm text-gray-700 dark:text-gray-400">
            Showing
            <span class="font-semibold text-black dark:text-slate-300">
              {{ commentPage.totalPages ? commentPage.currentPage + 1 : 0 }}
            </span>
            page out of
            <span class="font-semibold text-black dark:text-slate-300">
              {{ commentPage.totalPages }}
            </span>
            pages
          </span>
          <div class="inline-flex mt-2">
            <button
              (click)="
                this.fetchPreviousPageOfComments(commentPage.currentPage)
              "
              class="bg-white hover:bg-gray-50 font-medium rounded-lg border-2 text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-slate-800 dark:hover:bg-slate-700 dark:border-slate-700"
            >
              Prev
            </button>
            <button
              (click)="
                this.fetchNextPageOfComments(
                  commentPage.currentPage,
                  commentPage.isLast
                )
              "
              class="bg-white hover:bg-gray-50 font-medium rounded-lg border-2 text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-slate-800 dark:hover:bg-slate-700 dark:border-slate-700"
            >
              Next
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
